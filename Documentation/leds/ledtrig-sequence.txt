Sequence LED Trigger
====================

This is a LED trigger useful for headless system where the LEDs are the only
way to reflect system status.

Currently, none of available triggers supports playing with the LED brightness
level.  The sequence trigger provides a way to define custom brightness
sequence.
For example, it is easy to customize the sequence to mock up the rhythm of
human breathing which is a nice sequence to tell the user the system is doing
something.

This trigger is meant to be usable for waiting an event to happen, for example
when the system gets ready.  Those sequences may be used to reflect well known
system status (e.g. idle mode, startup...).

The application simply has to initialize some trigger parameters:
 - the preset sequence (brightness plot),
 - the constant interval of time between each brightness change and
 - the number of repeat (0 for an infinite loop).
Then, the application controls the life of the sequence using the commands
below:
 - "start"/"stop" to control the sequence,
 - "reset" to clear the repeat counter,
 - "pause"/"resume" to suspend or recover the sequence.

The trigger can be activated from user space on led class devices as shown
below:

  echo sequence > trigger

This adds the following sysfs attributes to the LED:

  plot - specifies the brightness level sequence (from LED_OFF to LED_FULL).
         Every values are separated by an end of line (0x0a).
         Default is a triangular sequence from LED_FULL to LED_OFF and LED_OFF
         to LED_FULL.

  rawplot - same as plot except the plot are given in binary format (array of
            bytes). Each bytes must be positive and range from LED_OFF to
            LED_FULL.

  interval - specifies the time elapsed between every brightness change.
             This interval remains constant along the sequence unless a change
             happened during the sequence execution.
             Default to 100 ms.

  repeat - specifies the number of sequences the trigger has to run.
           Set the repeat value to 0 will let the led repeats the same sequence
           till the end of time.
           Default to 0.

  count - get the current number of sequences. The counter is incrementing even
          for an infinite loop.

  control - tells the trigger what action to do.
            "start" will start a new number of sequences from 0 to repeat.
            "stop" will stop the sequence. The brightness level is left
            untouched and the number of sequences is reset to 0.
            "reset" will clear the number of sequences.
            "pause"/"resume" will pause/resume the sequence.

Sequence duration is determine by sizeof("plot") * "interval" ms.

Example use-case: headless system initialization with network device.
It runs the sequence till the device has received a IP from the DHCP server.

  echo sequence > trigger   # set trigger for this led
  echo 0 > repeat        # set loop forever
  echo 50 > interval     # set 50 ms between each brightness change
  cat << EOF > plot
255
254
254
253
...
2
1
1
0
EOF                      # customize the sequence with a smoother one (sinus)
  echo start > control   # starts the sequence trigger

dhcp lease bound or renewed: stop sequence and turn led on.

  echo stop > control   # halt the sequence
  echo 255 > brightness # and turn led on roughly
or
  echo 1 > count     # let the sequence to terminate
  echo 10 > interval # and accelerate the end of sequence smoothly

dhcp lease lost or being renewed: restart sequence.

  echo start > control
